# yamllint disable rule:line-length
---
name: setup environment

description: load values from 1password vault

inputs:

  instance:
    description: input value that can be used to control which actions are run
    required: false
    default: ""

runs:
  using: "composite"

  steps:

    - name: nonprod
      if: ${{ inputs.instance == 'nonprod' }}
      uses: 1password/load-secrets-action@v2
      with:
        export-env: true
      env:
        DOCKER_LOGIN: op://empc-lab/svc-dockerhub/username
        DOCKER_PASSWORD: op://empc-lab/svc-dockerhub/password
        COSIGN_PASSWORD: op://empc-lab/svc-cosign/passphrase
        SNYK_TOKEN: op://empc-lab/svc-snyk/api-token
        GREN_GITHUB_TOKEN: op://empc-lab/svc-github/access-token
        SLACK_BOT_TOKEN: op://empc-lab/svc-slack/post-bot-token
        CIRCLE_TOKEN: op://empc-lab/svc-circleci/api-token
